[UTILS CODE FROM PREVIOUS MESSAGE]